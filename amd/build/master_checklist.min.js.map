{"version":3,"file":"master_checklist.min.js","sources":["../src/master_checklist.js"],"sourcesContent":["import { BaseComponent } from 'core/reactive';\r\nimport { masterChecklistReactiveInstance } from 'mod_bookit/master_checklist_reactive';\r\nimport { SELECTORS } from 'mod_bookit/master_checklist_reactive';\r\nimport ModalForm from 'core_form/modalform';\r\nimport Templates from 'core/templates';\r\nimport * as Toast from 'core/toast';\r\nimport {getString} from 'core/str';\r\nimport Ajax from 'core/ajax';\r\n\r\nexport default class extends BaseComponent {\r\n\r\n    static getEvents() {\r\n        return {\r\n            categoryRendered: 'mod_bookit:master_checklist_category_rendered',\r\n        };\r\n    }\r\n\r\n    create(descriptor) {\r\n\r\n        window.console.log('create component: ' + descriptor.reactive.name);\r\n        window.console.log(\"selectors in create master checklist: \", SELECTORS);\r\n\r\n    }\r\n\r\n    static init(target, selectors) {\r\n        return new this({\r\n            element: document.querySelector(target),\r\n            reactive: masterChecklistReactiveInstance,\r\n            selectors: selectors || SELECTORS,\r\n        });\r\n    }\r\n\r\n\r\n    getWatchers() {\r\n        window.console.log('GET WATCHERS');\r\n        return [\r\n            {watch: 'state:updated', handler: this._handleStateEvent},\r\n            {watch: 'checklistcategories:created', handler: this._handleCategoryCreatedEvent},\r\n            {watch: 'checklistcategories:deleted', handler: this._handleCategoryDeletedEvent},\r\n            {watch: 'checklistcategories.name:updated', handler: this._handleCategoryNameUpdatedEvent},\r\n            {watch: 'checklistcategories.items:updated', handler: this._handleCategoryItemsUpdatedEvent},\r\n            {watch: 'checklistitems:created', handler: this._handleItemCreatedEvent},\r\n            {watch: 'checklistitems:deleted', handler: this._handleItemDeletedEvent},\r\n            {watch: 'checklistitems:updated', handler: this._handleItemUpdatedEvent},\r\n            {watch: 'checklistitems.categoryid:updated', handler: this._handleItemCategoryUpdatedEvent},\r\n            {watch: 'checklistitems.title:updated', handler: this._replaceRenderedItem},\r\n            {watch: 'checklistitems.roomid:updated', handler: this._replaceRenderedItem},\r\n            {watch: 'checklistitems.roleid:updated', handler: this._replaceRenderedItem},\r\n            {watch: 'activeRole:updated', handler: this._handleRoleUpdate},\r\n            {watch: 'activeRoom:updated', handler: this._handleRoomUpdate},\r\n        ];\r\n    }\r\n\r\n    stateReady(state) {\r\n\r\n        const name = state.masterchecklists.get(1).name;\r\n\r\n        const titleElement = this.getElement(this.selectors.MASTER_CHECKLIST_TITLE);\r\n\r\n        titleElement.innerHTML = name;\r\n\r\n        this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_ITEM_BUTTON), 'click', (e) => {\r\n            e.preventDefault();\r\n            this._handleAddChecklistItemButtonClick(e);\r\n        });\r\n\r\n        this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_CATEGORY_BUTTON), 'click', (e) => {\r\n            e.preventDefault();\r\n            this._handleAddChecklistCategoryButtonClick(e);\r\n        });\r\n\r\n        this.addEventListener(this.getElement(this.selectors.ROLE_SELECT), 'change', (e) => {\r\n            this.reactive.dispatch('roleChanged', { id: e.target.value });\r\n        });\r\n        this.addEventListener(this.getElement(this.selectors.ROOM_SELECT), 'change', (e) => {\r\n            this.reactive.dispatch('roomChanged', { id: e.target.value });\r\n        });\r\n\r\n    }\r\n\r\n    _handleStateEvent(event) {\r\n\r\n    }\r\n\r\n    async _handleAddChecklistItemButtonClick(event) {\r\n\r\n        // TODO do this in mutation instead\r\n        const modalForm = new ModalForm({\r\n            formClass: \"mod_bookit\\\\form\\\\edit_checklistitem_form\",\r\n            args: {\r\n                masterid: 1,\r\n                itemid: null,\r\n                categories: Array.from(this.reactive.state.checklistcategories.values()),\r\n            },\r\n            modalConfig: {\r\n                title: await getString('checklistitem', 'mod_bookit'),\r\n            },\r\n\r\n        });\r\n\r\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (response) => {\r\n            this.reactive.dispatch('checklistitemCreated', response.detail);\r\n        });\r\n\r\n        modalForm.show();\r\n    }\r\n\r\n    async _handleAddChecklistCategoryButtonClick(event) {\r\n        const modalForm = new ModalForm({\r\n            formClass: \"mod_bookit\\\\form\\\\edit_checklist_category_form\",\r\n            args: {\r\n                masterid: 1\r\n            },\r\n            modalConfig: {\r\n                title: await getString('checklistcategory', 'mod_bookit'),\r\n            },\r\n        });\r\n\r\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (response) => {\r\n            this.reactive.stateManager.processUpdates(response.detail);\r\n\r\n        });\r\n\r\n        modalForm.show();\r\n    }\r\n\r\n    _handleCategoryCreatedEvent(event) {\r\n        Templates.renderForPromise('mod_bookit/bookit_checklist_category',\r\n            {\r\n                id: event.element.id,\r\n                name: event.element.name,\r\n                order: event.element.order,\r\n                masterid: 1, // TODO get from state\r\n                type: 'category',\r\n            })\r\n            .then(({html, js}) => {\r\n                Templates.appendNodeContents(this.getElement(this.selectors.TABLE), html, js);\r\n            })\r\n            .then(async () => {\r\n                Toast.add(await getString('checklistcategorysuccess', 'mod_bookit'),\r\n                    {type: 'success' });\r\n            })\r\n            .catch();\r\n    }\r\n\r\n    _handleItemCreatedEvent(event) {\r\n        const targetElement = this.getElement(`#bookit-master-checklist-tbody-category-${event.element.category}`);\r\n\r\n        Templates.renderForPromise('mod_bookit/bookit_checklist_item',\r\n            {\r\n                id: event.element.id,\r\n                title: event.element.title,\r\n                order: event.element.order,\r\n                categoryid: event.element.category,\r\n                roomid: event.element.roomid,\r\n                roomname: event.element.roomname,\r\n                roleid: event.element.roleid,\r\n                rolename: event.element.rolename,\r\n                type: 'item',\r\n            })\r\n            .then(({html, js}) => {\r\n                Templates.appendNodeContents(targetElement, html, js);\r\n            })\r\n            .then(async () => {\r\n                Toast.add(await getString('checklistitemsuccess', 'mod_bookit'),\r\n                    {type: 'success' });\r\n            })\r\n            .catch(error => {\r\n                window.console.error('Error rendering checklist item:', error);\r\n            });\r\n    }\r\n\r\n    _handleItemDeletedEvent(event) {\r\n        const targetElement = this.getElement(`#bookit-master-checklist-item-${event.element.id}`);\r\n        targetElement.remove();\r\n\r\n        Toast.add(getString('checklistitemdeleted', 'mod_bookit', {title: event.element.title}),\r\n            {type: 'success' });\r\n    }\r\n\r\n    _handleItemUpdatedEvent(event) {\r\n        //TODO remove\r\n    }\r\n\r\n    _replaceRenderedItem(event) {\r\n\r\n        const actionParts = event.action.split('.');\r\n        const fieldPart = actionParts[1].split(':')[0];\r\n\r\n        const elementSelector = `td[data-bookit-checklistitem-tabledata-${fieldPart}-id=\"${event.element.id}\"]`;\r\n\r\n        const targetElement = this.getElement(elementSelector);\r\n\r\n        if (fieldPart.endsWith('id')) {\r\n            const nameField = fieldPart.substring(0, fieldPart.length - 2) + 'name';\r\n\r\n            if (nameField in event.element) {\r\n                targetElement.innerHTML = event.element[nameField];\r\n            }\r\n        } else {\r\n            targetElement.innerHTML = event.element[fieldPart];\r\n        }\r\n\r\n    }\r\n\r\n    _handleItemCategoryUpdatedEvent(event) {\r\n        const itemObject = this.reactive.state.checklistitems.get(event.element.id);\r\n\r\n        const formDataObj = {\r\n            itemid: itemObject.id,\r\n            masterid: 1,\r\n            title: itemObject.title,\r\n            categoryid: itemObject.categoryid,\r\n            roomid: itemObject.roomid,\r\n            roleid: itemObject.roleid,\r\n            action: 'put',\r\n            _qf__mod_bookit_form_edit_checklistitem_form: 1,\r\n        };\r\n\r\n        const formData = new URLSearchParams(formDataObj).toString();\r\n        // TODO move to mutation\r\n        Ajax.call([{\r\n            methodname: 'core_form_dynamic_form',\r\n            args: {\r\n                formdata: formData,\r\n                form: 'mod_bookit\\\\form\\\\edit_checklistitem_form'\r\n            }\r\n            }])[0]\r\n            .then((response) => {\r\n                // TODO handle response?\r\n                })\r\n                .catch(exception => {\r\n                    window.console.error('AJAX error:', exception);\r\n                });\r\n\r\n    }\r\n\r\n    _handleCategoryDeletedEvent(event) {\r\n        const targetElement = this.getElement(`#bookit-master-checklist-tbody-category-${event.element.id}`);\r\n\r\n        targetElement.remove();\r\n\r\n        Toast.add(getString('checklistcategorydeleted', 'mod_bookit', {name: event.element.name}),\r\n            {type: 'success' });\r\n    }\r\n\r\n    _handleCategoryNameUpdatedEvent(event) {\r\n        const targetElement = this.getElement(`#bookit-master-checklist-category-row-${event.element.id}`);\r\n\r\n        Templates.renderForPromise('mod_bookit/bookit_checklist_category_row',\r\n            {\r\n                id: event.element.id,\r\n                name: event.element.name,\r\n                order: event.element.order,\r\n            })\r\n            .then(({html, js}) => {\r\n                Templates.replaceNode(targetElement, html, js);\r\n\r\n            })\r\n            .then(async () => {\r\n                Toast.add(await getString('checklistcategoryupdatesuccess', 'mod_bookit'),\r\n                    {type: 'success' });\r\n                    this.dispatchEvent(this.events.categoryRendered, {\r\n                        categoryId: event.element.id\r\n                    });\r\n            })\r\n            .catch(error => {\r\n                window.console.error('Error rendering checklist category:', error);\r\n            });\r\n\r\n    }\r\n\r\n    _handleCategoryItemsUpdatedEvent(event) {\r\n        const targetElement = this.getElement(`#bookit-master-checklist-tbody-category-${event.element.id}`);\r\n\r\n        const category = this.reactive.state.checklistcategories.get(event.element.id);\r\n\r\n        const formDataObj = {\r\n            id: category.id,\r\n            masterid: 1,\r\n            name: category.name,\r\n            checklistitems: category.items,\r\n            action: 'put',\r\n            _qf__mod_bookit_form_edit_checklist_category_form: 1,\r\n        };\r\n\r\n        const formData = new URLSearchParams(formDataObj).toString();\r\n        // TODO move to mutation\r\n        Ajax.call([{\r\n            methodname: 'core_form_dynamic_form',\r\n            args: {\r\n                formdata: formData,\r\n                form: 'mod_bookit\\\\form\\\\edit_checklist_category_form'\r\n            }\r\n        }])[0]\r\n        .then((response) => {\r\n            // TODO handle response?\r\n        })\r\n        .catch(exception => {\r\n            window.console.error('AJAX error:', exception);\r\n\r\n        });\r\n    }\r\n\r\n    _handleRoleUpdate(event) {\r\n        const allCategoryElements = document.querySelectorAll(this.selectors.ALL_CATEGORY_TABLE_ROWS);\r\n        allCategoryElements.forEach(categoryElement => {\r\n\r\n            const category = this.reactive.state.checklistcategories.get(categoryElement.dataset.bookitCategoryId);\r\n            const items = [...category.items];\r\n            var hasVisibleItems = false;\r\n\r\n            const activeRoom = this.reactive.state.activeRoom.id;\r\n\r\n            items.forEach(itemId => {\r\n\r\n                const itemElement = document.querySelector(`tr[data-bookit-checklistitem-id=\"${itemId}\"]`);\r\n\r\n                if (activeRoom === 0) {\r\n\r\n                    if (parseInt(itemElement.dataset.bookitChecklistitemRole) === event.element.id ||  event.element.id === 0) {\r\n                        itemElement.classList.remove('d-none');\r\n                        if (!hasVisibleItems) {\r\n                            hasVisibleItems = true;\r\n                        }\r\n                    } else {\r\n                        itemElement.classList.add('d-none');\r\n                    }\r\n                } else if (activeRoom === parseInt(itemElement.dataset.bookitChecklistitemRoom)) {\r\n\r\n                    if (parseInt(itemElement.dataset.bookitChecklistitemRole) === event.element.id || event.element.id === 0) {\r\n                        itemElement.classList.remove('d-none');\r\n                        if (!hasVisibleItems) {\r\n                            hasVisibleItems = true;\r\n                        }\r\n                    } else {\r\n                        itemElement.classList.add('d-none');\r\n                    }\r\n                } else {\r\n\r\n                    itemElement.classList.add('d-none');\r\n                }\r\n            });\r\n\r\n            if (!hasVisibleItems) {\r\n                categoryElement.classList.add('d-none');\r\n            } else {\r\n                categoryElement.classList.remove('d-none');\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    _handleRoomUpdate(event) {\r\n\r\n        const allCategoryElements = document.querySelectorAll(this.selectors.ALL_CATEGORY_TABLE_ROWS);\r\n        allCategoryElements.forEach(categoryElement => {\r\n\r\n            const category = this.reactive.state.checklistcategories.get(categoryElement.dataset.bookitCategoryId);\r\n\r\n            const items = [...category.items];\r\n\r\n            var hasVisibleItems = false;\r\n\r\n            const activeRole = this.reactive.state.activeRole.id;\r\n\r\n            items.forEach(itemId => {\r\n                const itemElement = document.querySelector(`tr[data-bookit-checklistitem-id=\"${itemId}\"]`);\r\n\r\n                if (parseInt(itemElement.dataset.bookitChecklistitemRoom) === event.element.id) {\r\n                    if (activeRole === 0 || parseInt(itemElement.dataset.bookitChecklistitemRole) === activeRole) {\r\n                        itemElement.classList.remove('d-none');\r\n                        if (!hasVisibleItems) {\r\n                            hasVisibleItems = true;\r\n                        }\r\n                    } else {\r\n                        itemElement.classList.add('d-none');\r\n                    }\r\n                } else {\r\n\r\n                    if (event.element.id === 0 &&\r\n                        (parseInt(itemElement.dataset.bookitChecklistitemRole) === activeRole || activeRole === 0)) {\r\n                        itemElement.classList.remove('d-none');\r\n                        if (!hasVisibleItems) {\r\n                            hasVisibleItems = true;\r\n                        }\r\n                    } else {\r\n                        itemElement.classList.add('d-none');\r\n                    }\r\n                }\r\n            });\r\n\r\n            if (!hasVisibleItems) {\r\n                categoryElement.classList.add('d-none');\r\n            } else {\r\n                categoryElement.classList.remove('d-none');\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n}"],"names":["BaseComponent","categoryRendered","create","descriptor","window","console","log","reactive","name","SELECTORS","target","selectors","this","element","document","querySelector","masterChecklistReactiveInstance","getWatchers","watch","handler","_handleStateEvent","_handleCategoryCreatedEvent","_handleCategoryDeletedEvent","_handleCategoryNameUpdatedEvent","_handleCategoryItemsUpdatedEvent","_handleItemCreatedEvent","_handleItemDeletedEvent","_handleItemUpdatedEvent","_handleItemCategoryUpdatedEvent","_replaceRenderedItem","_handleRoleUpdate","_handleRoomUpdate","stateReady","state","masterchecklists","get","getElement","MASTER_CHECKLIST_TITLE","innerHTML","addEventListener","ADD_CHECKLIST_ITEM_BUTTON","e","preventDefault","_handleAddChecklistItemButtonClick","ADD_CHECKLIST_CATEGORY_BUTTON","_handleAddChecklistCategoryButtonClick","ROLE_SELECT","dispatch","id","value","ROOM_SELECT","event","modalForm","ModalForm","formClass","args","masterid","itemid","categories","Array","from","checklistcategories","values","modalConfig","title","events","FORM_SUBMITTED","response","detail","show","stateManager","processUpdates","renderForPromise","order","type","then","_ref","html","js","appendNodeContents","TABLE","async","Toast","add","catch","targetElement","category","categoryid","roomid","roomname","roleid","rolename","_ref2","error","remove","fieldPart","action","split","elementSelector","endsWith","nameField","substring","length","itemObject","checklistitems","formDataObj","_qf__mod_bookit_form_edit_checklistitem_form","formData","URLSearchParams","toString","call","methodname","formdata","form","exception","_ref3","replaceNode","dispatchEvent","categoryId","items","_qf__mod_bookit_form_edit_checklist_category_form","querySelectorAll","ALL_CATEGORY_TABLE_ROWS","forEach","categoryElement","dataset","bookitCategoryId","hasVisibleItems","activeRoom","itemId","itemElement","parseInt","bookitChecklistitemRole","classList","bookitChecklistitemRoom","activeRole"],"mappings":"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"}