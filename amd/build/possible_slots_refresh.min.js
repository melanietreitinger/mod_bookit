define("mod_bookit/possible_slots_refresh",["exports","core/ajax"],(function(_exports,Ajax){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initPossibleStarttimesRefresh=
/**
   * Fresh possible slots in the booking form.
   *
   * @module     mod_bookit/possible_slots_refresh
   * @copyright  2025 Justus Dieckmann RUB
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
function initPossibleStarttimesRefresh(){const formEl=document.querySelector(".modal-body form");if(!formEl)return void setTimeout(initPossibleStarttimesRefresh,50);const roomEl=formEl.querySelector('select[name="roomid"]'),durationEl=formEl.querySelector('select[name="duration"]'),dateDayEl=formEl.querySelector('select[name="startdate[day]"]'),dateMonthEl=formEl.querySelector('select[name="startdate[month]"]'),dateYearEl=formEl.querySelector('select[name="startdate[year]"]'),timeEl=formEl.querySelector('select[name="starttime"]'),refreshStarttimes=async()=>{const selectedTime=timeEl.value,year=parseInt(dateYearEl.value),month=parseInt(dateMonthEl.value),day=parseInt(dateDayEl.value),starttimes=await Ajax.call([{methodname:"mod_bookit_get_possible_starttimes",args:{year:year,month:month,day:day,duration:durationEl.value,roomid:roomEl.value}}])[0];for(;timeEl.options.length;)timeEl.options.remove(0);for(let slot of starttimes){const opt=document.createElement("option");opt.value=slot.timestamp,opt.innerText=slot.string,slot===selectedTime&&(opt.selected=!0),timeEl.options.add(opt)}};for(let el of[roomEl,durationEl,dateDayEl,dateMonthEl,dateYearEl])el.addEventListener("change",refreshStarttimes);refreshStarttimes()},Ajax=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(Ajax)}));

//# sourceMappingURL=possible_slots_refresh.min.js.map