{"version":3,"file":"master_checklist_item.min.js","sources":["../../src/masterchecklist/master_checklist_item.js"],"sourcesContent":["import {BaseComponent, DragDrop} from 'core/reactive';\r\nimport {masterChecklistReactiveInstance} from 'mod_bookit/masterchecklist/master_checklist_reactive';\r\nimport {SELECTORS} from 'mod_bookit/masterchecklist/master_checklist_reactive';\r\nimport ModalForm from 'core_form/modalform';\r\nimport {getString} from 'core/str';\r\nimport Templates from 'core/templates';\r\nimport Notification from 'core/notification';\r\n\r\nexport default class extends BaseComponent {\r\n\r\n    static MODAL_TIMEOUT_MS = 500;\r\n\r\n    create(descriptor) {\r\n\r\n        const itemEditBtnSelector = 'EDIT_CHECKLISTITEM_BTN_' + descriptor.element.dataset.bookitChecklistitemId;\r\n        this.selectors[itemEditBtnSelector] = `#edit-checklistitem-${descriptor.element.dataset.bookitChecklistitemId}`;\r\n    }\r\n\r\n    static init(target, selectors) {\r\n        return new this({\r\n            element: document.querySelector(target),\r\n            reactive: masterChecklistReactiveInstance,\r\n            selectors: selectors || SELECTORS,\r\n        });\r\n    }\r\n\r\n    getWatchers() {\r\n        return [];\r\n    }\r\n\r\n    stateReady() {\r\n\r\n        this.dragdrop = new DragDrop(this);\r\n\r\n        const itemEditBtnSelector = 'EDIT_CHECKLISTITEM_BTN_' + this.element.dataset.bookitChecklistitemId;\r\n\r\n        this.addEventListener(this.getElement(this.selectors[itemEditBtnSelector]), 'click', (e) => {\r\n            e.preventDefault();\r\n            this._handleEditChecklistItemButtonClick(e);\r\n        });\r\n\r\n        this.shouldBeVisible();\r\n\r\n    }\r\n\r\n    destroy() {\r\n        if (this.dragdrop !== undefined) {\r\n            this.dragdrop.unregister();\r\n        }\r\n    }\r\n\r\n    validateDropData() {\r\n        return true;\r\n    }\r\n\r\n    drop(dropdata, event) {\r\n        switch (dropdata.type) {\r\n            case 'item':\r\n                this._handleItemDrop(dropdata, event);\r\n                break;\r\n            case 'category':\r\n                this._handleCategoryDrop(dropdata, event);\r\n                break;\r\n            default:\r\n                throw new Error(`Unknown drop type: ${dropdata.type}`);\r\n        }\r\n    }\r\n\r\n\r\n    showDropZone(dropdata) {\r\n\r\n        const root = document.querySelector('html');\r\n        const primaryColor = getComputedStyle(root).getPropertyValue('--primary');\r\n\r\n        switch (dropdata.type) {\r\n            case 'item': {\r\n                this.element.style.boxShadow = `0px -5px 0px 0px ${primaryColor} inset`;\r\n                this.element.style.transition = 'box-shadow 0.1s ease';\r\n                break;\r\n            }\r\n            case 'category': {\r\n                const itemParentId = parseInt(this.element.dataset.bookitChecklistitemCategoryid);\r\n                const categoryParentElement = document.getElementById(`bookit-master-checklist-tbody-category-${itemParentId}`);\r\n                var isActive = parseInt(categoryParentElement.dataset.bookitCategoryActive || 0);\r\n                if (!isActive) {\r\n                    categoryParentElement.dataset.bookitCategoryActive = 1;\r\n                }\r\n                const categoryLastChild = categoryParentElement.lastElementChild;\r\n                setTimeout(() => {\r\n                    categoryParentElement.dataset.bookitCategoryActive = 0;\r\n                }, 5);\r\n                categoryLastChild.style.boxShadow = `0px -5px 0px 0px ${primaryColor} inset`;\r\n                categoryLastChild.style.transition = 'box-shadow 0.1s ease';\r\n                break;\r\n            }\r\n            default:\r\n                throw new Error(`Unknown drop type: ${dropdata.type}`);\r\n        }\r\n\r\n    }\r\n\r\n    hideDropZone(dropdata) {\r\n\r\n        switch (dropdata.type) {\r\n            case 'item': {\r\n                this.element.style.boxShadow = '';\r\n                this.element.style.transition = '';\r\n                break;\r\n            }\r\n            case 'category': {\r\n                const itemParentId = parseInt(this.element.dataset.bookitChecklistitemCategoryid);\r\n                const categoryParentElement = document.getElementById(`bookit-master-checklist-tbody-category-${itemParentId}`);\r\n                const categoryLastChild = categoryParentElement.lastElementChild;\r\n                var isActive = parseInt(categoryParentElement.dataset.bookitCategoryActive || 0);\r\n                if (!isActive) {\r\n                    categoryLastChild.style.boxShadow = '';\r\n                    categoryLastChild.style.transition = '';\r\n                }\r\n                break;\r\n            }\r\n            default:\r\n                throw new Error(`Unknown drop type: ${dropdata.type}`);\r\n        }\r\n\r\n    }\r\n\r\n    _handleItemDrop(dropdata) {\r\n        dropdata.targetId = parseInt(this.element.dataset.bookitChecklistitemId);\r\n        dropdata.targetParentId = parseInt(this.element.dataset.bookitChecklistitemCategoryid);\r\n\r\n        this.reactive.dispatch('reOrderCategoryItems', dropdata);\r\n\r\n        const itemObject = this.reactive.state.checklistitems.get(dropdata.id);\r\n\r\n        const itemElement = document.getElementById(`bookit-master-checklist-item-${itemObject.id}`);\r\n\r\n        const itemHasChangedParent = dropdata.parentId !== dropdata.targetParentId;\r\n\r\n        if (itemHasChangedParent) {\r\n            itemElement.dataset.bookitChecklistitemCategoryid = dropdata.targetParentId;\r\n        }\r\n\r\n        this.element.parentNode.insertBefore(itemElement, this.element.nextElementSibling);\r\n    }\r\n\r\n\r\n    _handleCategoryDrop(dropdata, event) {\r\n        const categoryElement = document.getElementById(`bookit-master-checklist-tbody-category-${dropdata.id}`);\r\n\r\n        dropdata.targetId = this.element.dataset.bookitChecklistitemCategoryid;\r\n        dropdata.targetParentId = categoryElement.dataset.bookitCategoryMasterid;\r\n\r\n        this.reactive.dispatch('reOrderCategories', dropdata);\r\n\r\n        const tableElement = document.querySelector(this.selectors.TABLE);\r\n\r\n        categoryElement.dataset.bookitCategoryActive = 1;\r\n\r\n        this.hideDropZone(dropdata, event);\r\n\r\n        tableElement.insertBefore(categoryElement, this.element.parentNode.nextElementSibling);\r\n    }\r\n\r\n\r\n    async _handleEditChecklistItemButtonClick(event) {\r\n        const modalForm = new ModalForm({\r\n            formClass: \"mod_bookit\\\\local\\\\form\\\\masterchecklist\\\\edit_checklist_item_form\",\r\n            moduleName: 'mod_bookit/modal_delete_save_cancel',\r\n            args: {\r\n                masterid: 1,\r\n                itemid: event.currentTarget.value,\r\n                categories: Array.from(this.reactive.state.checklistcategories.values()),\r\n            },\r\n            modalConfig: {\r\n                title: await getString('checklistitem', 'mod_bookit'),\r\n            },\r\n\r\n        });\r\n\r\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (response) => {\r\n            this.reactive.stateManager.processUpdates(response.detail);\r\n\r\n            if (response.detail[0].action === 'delete') {\r\n                this.reactive.dispatch('checklistitemDeleted',\r\n                    {\r\n                        id: parseInt(response.detail[0].fields.id),\r\n                        categoryid: parseInt(this.element.dataset.bookitChecklistitemCategoryid),\r\n                    });\r\n                this.remove();\r\n                return;\r\n            }\r\n\r\n            const parentId = parseInt(this.element.dataset.bookitChecklistitemCategoryid);\r\n            const updatedParentId = parseInt(response.detail[0].fields.categoryid);\r\n\r\n            if (parentId !== updatedParentId) {\r\n\r\n                const targetParentCategoryObject =\r\n                    this.reactive.state.checklistcategories.get(response.detail[0].fields.categoryid);\r\n                const copiedArray = [...targetParentCategoryObject.items];\r\n                const lastItemOfParentCategoryId = copiedArray.pop();\r\n\r\n                const data = {\r\n                    id: parseInt(this.element.dataset.bookitChecklistitemId),\r\n                    type: 'item',\r\n                    parentId: parentId,\r\n                    targetId: lastItemOfParentCategoryId,\r\n                    targetParentId: updatedParentId,\r\n                };\r\n\r\n                this.reactive.dispatch('reOrderCategoryItems', data);\r\n                this.element.dataset.bookitChecklistitemCategoryid = data.targetParentId;\r\n\r\n                const targetParentElement =\r\n                    document.getElementById(`bookit-master-checklist-tbody-category-${data.targetParentId}`);\r\n                targetParentElement.append(this.element);\r\n            }\r\n\r\n\r\n        });\r\n\r\n        modalForm.addEventListener(modalForm.events.LOADED, () => {\r\n            const deleteButton = modalForm.modal.getRoot().find('button[data-action=\"delete\"]');\r\n\r\n            deleteButton.on('click', async(e) => {\r\n                e.preventDefault();\r\n\r\n                const confirmTitle = await getString('confirm', 'core');\r\n                const confirmMessage = await getString('areyousure', 'core');\r\n                const deleteText = await getString('delete', 'core');\r\n\r\n                Notification.deleteCancel(\r\n                    confirmTitle,\r\n                    confirmMessage,\r\n                    deleteText,\r\n                    () => {\r\n                        modalForm.getFormNode().querySelector('input[name=\"action\"]').value = 'delete';\r\n                        modalForm.submitFormAjax();\r\n                    }\r\n                );\r\n\r\n            });\r\n\r\n            setTimeout(() => {\r\n                this._addResetButtonsToNotificationEditors(modalForm);\r\n            }, this.constructor.MODAL_TIMEOUT_MS);\r\n\r\n            setTimeout(() => {\r\n                this._addRequiredIconsToNotificationFields(modalForm);\r\n            }, this.constructor.MODAL_TIMEOUT_MS);\r\n\r\n        });\r\n\r\n        modalForm.addEventListener(modalForm.events.SERVER_VALIDATION_ERROR, () => {\r\n            setTimeout(() => {\r\n                this._addResetButtonsToNotificationEditors(modalForm);\r\n                this._addRequiredIconsToNotificationFields(modalForm);\r\n            }, this.constructor.MODAL_TIMEOUT_MS);\r\n        });\r\n\r\n        modalForm.show();\r\n    }\r\n\r\n    /**\r\n     * Add required icons to notification fields\r\n     * @param {ModalForm} modalForm The modal form instance\r\n     */\r\n    _addRequiredIconsToNotificationFields(modalForm) {\r\n        const notificationTypes = ['before_due', 'when_due', 'overdue', 'when_done'];\r\n\r\n        notificationTypes.forEach(type => {\r\n            const recipientElement = modalForm.getFormNode().querySelector(`[id^=\"fitem_id_${type}_recipient_\"]`);\r\n            if (recipientElement) {\r\n                const firstDiv = recipientElement.firstElementChild;\r\n                if (firstDiv) {\r\n                    const formLabelAddon = firstDiv.querySelector('.form-label-addon');\r\n                    if (formLabelAddon && formLabelAddon.firstElementChild) {\r\n                        const anchorElement = formLabelAddon.firstElementChild;\r\n                        this._addRequiredIcon(anchorElement, type, 'recipient');\r\n                    }\r\n                }\r\n            }\r\n\r\n            const timeElement = modalForm.getFormNode().querySelector(`[id^=\"fitem_id_${type}_time_\"]`);\r\n            if (timeElement) {\r\n                const firstDiv = timeElement.firstElementChild;\r\n                if (firstDiv) {\r\n                    const formLabelAddon = firstDiv.querySelector('.form-label-addon');\r\n                    if (formLabelAddon && formLabelAddon.firstElementChild) {\r\n                        const anchorElement = formLabelAddon.firstElementChild;\r\n                        this._addRequiredIcon(anchorElement, type, 'time');\r\n                    }\r\n                }\r\n            }\r\n\r\n            const messagetextElement = modalForm.getFormNode().querySelector(`[id^=\"fitem_id_${type}_messagetext_\"]`);\r\n            if (messagetextElement) {\r\n                const firstDiv = messagetextElement.firstElementChild;\r\n                if (firstDiv) {\r\n                    const formLabelAddon = firstDiv.querySelector('.form-label-addon');\r\n                    if (formLabelAddon && formLabelAddon.firstElementChild) {\r\n                        const anchorElement = formLabelAddon.firstElementChild;\r\n                        this._addRequiredIcon(anchorElement, type, 'messagetext');\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Helper method to add required icon to an element\r\n     * @param {Element} anchorElement The anchor element to insert before\r\n     */\r\n    _addRequiredIcon(anchorElement) {\r\n        Templates.renderForPromise('core/pix_icon_fontawesome', {\r\n            key: 'fa-circle-exclamation',\r\n            title: 'Required',\r\n            alt: 'Required field',\r\n            extraclasses: 'fa text-danger fa-fw',\r\n            'aria-hidden': false,\r\n            unmappedIcon: false\r\n        })\r\n        .then((result) => {\r\n            const iconHtml = result.html;\r\n            const requiredIconHtml = `<div class=\"text-danger\" title=\"Required\" aria-hidden=\"true\">${iconHtml}</div>`;\r\n            anchorElement.insertAdjacentHTML('beforebegin', requiredIconHtml);\r\n            return;\r\n        })\r\n        .catch(() => {\r\n            // Template error silently ignored.\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Add reset buttons to notification type message editors\r\n     * @param {ModalForm} modalForm The modal form instance\r\n     */\r\n    _addResetButtonsToNotificationEditors(modalForm) {\r\n        const notificationTypes = ['before_due', 'when_due', 'overdue', 'when_done'];\r\n\r\n        notificationTypes.forEach(type => {\r\n            const resetButton = modalForm.getFormNode().querySelector(`button[name=\"${type}_reset\"]`);\r\n\r\n            if (resetButton) {\r\n                resetButton.addEventListener('click', async(e) => {\r\n                    e.preventDefault();\r\n\r\n                    try {\r\n                        const confirmTitle = await getString('confirm', 'core');\r\n                        const confirmMessage = await getString('resetmessagetoconfirm', 'mod_bookit');\r\n\r\n                        Notification.deleteCancel(\r\n                            confirmTitle,\r\n                            confirmMessage,\r\n                            await getString('reset', 'core'),\r\n                            async() => {\r\n                                await this._performReset(modalForm, type);\r\n                            }\r\n                        );\r\n\r\n                    } catch (error) {\r\n                        window.console.error('Error showing confirmation dialog:', error);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Helper method to perform the reset operation\r\n     * @param {ModalForm} modalForm The modal form instance\r\n     * @param {string} type The notification type\r\n     */\r\n    async _performReset(modalForm, type) {\r\n        const defaultMessage = await getString(`customtemplatedefaultmessage_${type}`, 'mod_bookit');\r\n\r\n        const editorSelector = `[name=\"${type}_messagetext[text]\"]`;\r\n        const textarea = modalForm.getFormNode().querySelector(editorSelector);\r\n\r\n        if (textarea) {\r\n            textarea.value = defaultMessage;\r\n            textarea.dispatchEvent(new Event('input', {bubbles: true}));\r\n            textarea.dispatchEvent(new Event('change', {bubbles: true}));\r\n\r\n            if (window.M && window.M.editor_atto && textarea.id) {\r\n                const editorInstance = window.M.editor_atto.get(textarea.id);\r\n                if (editorInstance) {\r\n                    editorInstance.updateOriginal();\r\n                }\r\n            }\r\n        }\r\n\r\n        if (window.tinymce) {\r\n            const editorId = textarea?.id;\r\n            if (editorId) {\r\n                const editor = window.tinymce.get(editorId);\r\n                if (editor) {\r\n                    editor.setContent(defaultMessage);\r\n                    editor.save();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    shouldBeVisible() {\r\n        const activeRooms = this.reactive.state.activeRoom;\r\n        const activeRoleId = this.reactive.state.activeRole.id;\r\n        const itemId = parseInt(this.element.dataset.bookitChecklistitemId);\r\n        const stateItem = this.reactive.state.checklistitems.get(itemId);\r\n        const roomIds = stateItem.roomids;\r\n        const roleIds = stateItem.roleids;\r\n\r\n        var isInRoom = false;\r\n\r\n        const noRoomSelection = activeRooms.some(room => {\r\n            return room.id == 0;\r\n        });\r\n\r\n        let parsedRoomIds;\r\n        try {\r\n            parsedRoomIds = JSON.parse(roomIds);\r\n        } catch (error) {\r\n            parsedRoomIds = roomIds;\r\n        }\r\n\r\n        let hasMatchingRoom = false;\r\n        if (Array.isArray(parsedRoomIds)) {\r\n            hasMatchingRoom = activeRooms.some(activeRoom =>\r\n                parsedRoomIds.includes(activeRoom.id.toString())\r\n            );\r\n        } else {\r\n            hasMatchingRoom = activeRooms.some(activeRoom =>\r\n                activeRoom.id.toString() === parsedRoomIds.toString()\r\n            );\r\n        }\r\n\r\n        if (noRoomSelection || hasMatchingRoom) {\r\n            isInRoom = true;\r\n        }\r\n\r\n        var hasRole = false;\r\n\r\n        if (activeRoleId == 0 || roleIds.includes(activeRoleId.toString())) {\r\n            hasRole = true;\r\n        }\r\n\r\n        const shouldBeVisible = isInRoom && hasRole;\r\n\r\n        if (!shouldBeVisible) {\r\n            this.element.classList.add('d-none');\r\n        } else {\r\n            this.element.classList.remove('d-none');\r\n        }\r\n\r\n        return shouldBeVisible;\r\n    }\r\n}"],"names":["BaseComponent","create","descriptor","itemEditBtnSelector","element","dataset","bookitChecklistitemId","selectors","target","this","document","querySelector","reactive","masterChecklistReactiveInstance","SELECTORS","getWatchers","stateReady","dragdrop","DragDrop","addEventListener","getElement","e","preventDefault","_handleEditChecklistItemButtonClick","shouldBeVisible","destroy","undefined","unregister","validateDropData","drop","dropdata","event","type","_handleItemDrop","_handleCategoryDrop","Error","showDropZone","root","primaryColor","getComputedStyle","getPropertyValue","style","boxShadow","transition","itemParentId","parseInt","bookitChecklistitemCategoryid","categoryParentElement","getElementById","bookitCategoryActive","categoryLastChild","lastElementChild","setTimeout","hideDropZone","targetId","targetParentId","dispatch","itemObject","state","checklistitems","get","id","itemElement","parentId","parentNode","insertBefore","nextElementSibling","categoryElement","bookitCategoryMasterid","tableElement","TABLE","modalForm","ModalForm","formClass","moduleName","args","masterid","itemid","currentTarget","value","categories","Array","from","checklistcategories","values","modalConfig","title","events","FORM_SUBMITTED","response","stateManager","processUpdates","detail","action","fields","categoryid","remove","updatedParentId","lastItemOfParentCategoryId","items","pop","data","append","LOADED","modal","getRoot","find","on","async","confirmTitle","confirmMessage","deleteText","deleteCancel","getFormNode","submitFormAjax","_addResetButtonsToNotificationEditors","constructor","MODAL_TIMEOUT_MS","_addRequiredIconsToNotificationFields","SERVER_VALIDATION_ERROR","show","forEach","recipientElement","firstDiv","firstElementChild","formLabelAddon","anchorElement","_addRequiredIcon","timeElement","messagetextElement","renderForPromise","key","alt","extraclasses","unmappedIcon","then","result","iconHtml","html","requiredIconHtml","insertAdjacentHTML","catch","resetButton","_performReset","error","window","console","defaultMessage","editorSelector","textarea","dispatchEvent","Event","bubbles","M","editor_atto","editorInstance","updateOriginal","tinymce","editorId","editor","setContent","save","activeRooms","activeRoom","activeRoleId","activeRole","itemId","stateItem","roomIds","roomids","roleIds","roleids","isInRoom","noRoomSelection","some","room","parsedRoomIds","JSON","parse","hasMatchingRoom","isArray","includes","toString","hasRole","classList","add"],"mappings":"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"}