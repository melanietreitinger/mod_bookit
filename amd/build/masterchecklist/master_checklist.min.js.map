{"version":3,"file":"master_checklist.min.js","sources":["../../src/masterchecklist/master_checklist.js"],"sourcesContent":["import {BaseComponent} from 'core/reactive';\r\nimport {masterChecklistReactiveInstance} from 'mod_bookit/masterchecklist/master_checklist_reactive';\r\nimport {SELECTORS} from 'mod_bookit/masterchecklist/master_checklist_reactive';\r\nimport ModalForm from 'core_form/modalform';\r\nimport Templates from 'core/templates';\r\nimport * as Toast from 'core/toast';\r\nimport {getString} from 'core/str';\r\nimport ChecklistHelper from 'mod_bookit/helpers/checklist_helper';\r\n\r\nexport default class extends BaseComponent {\r\n\r\n    static getEvents() {\r\n        return {\r\n            categoryRendered: 'mod_bookit:master_checklist_category_rendered',\r\n        };\r\n    }\r\n\r\n    static init(target, selectors) {\r\n        return new this({\r\n            element: document.querySelector(target),\r\n            reactive: masterChecklistReactiveInstance,\r\n            selectors: selectors || SELECTORS,\r\n        });\r\n    }\r\n\r\n    create() {\r\n        this.helper = new ChecklistHelper();\r\n    }\r\n\r\n    getWatchers() {\r\n        return [\r\n            {watch: 'checklistcategories:created', handler: this._handleCategoryCreatedEvent},\r\n            {watch: 'checklistcategories:deleted', handler: this._handleCategoryDeletedEvent},\r\n            {watch: 'checklistcategories.name:updated', handler: this._handleCategoryNameUpdatedEvent},\r\n            {watch: 'checklistitems:created', handler: this._handleItemCreatedEvent},\r\n            {watch: 'checklistitems:deleted', handler: this._handleItemDeletedEvent},\r\n            {watch: 'checklistitems.title:updated', handler: this._replaceRenderedItem},\r\n            {watch: 'checklistitems.roomids:updated', handler: this._replaceRenderedItem},\r\n            {watch: 'checklistitems.roleids:updated', handler: this._replaceRenderedItem},\r\n            {watch: 'activeRoom:created', handler: this._handleFilterUpdate},\r\n        ];\r\n    }\r\n\r\n    stateReady(state) {\r\n\r\n        const name = state.masterchecklists.get(1).name;\r\n\r\n        const titleElement = this.getElement(this.selectors.MASTER_CHECKLIST_TITLE);\r\n\r\n        titleElement.innerHTML = name;\r\n\r\n        this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_ITEM_BUTTON), 'click', (e) => {\r\n            e.preventDefault();\r\n            this._handleAddChecklistItemButtonClick(e);\r\n        });\r\n\r\n        this.addEventListener(this.getElement(this.selectors.ADD_CHECKLIST_CATEGORY_BUTTON), 'click', (e) => {\r\n            e.preventDefault();\r\n            this._handleAddChecklistCategoryButtonClick(e);\r\n        });\r\n\r\n        this.addEventListener(this.getElement(this.selectors.ROLE_SELECT), 'change', (e) => {\r\n            this.reactive.dispatch('roleChanged', {id: e.target.value});\r\n        });\r\n        this.addEventListener(this.getElement(this.selectors.ROOM_SELECT), 'change', (e) => {\r\n\r\n            // XXX TODO we need to dispatch all selected values\r\n\r\n            this.reactive.dispatch('roomChanged', {options: e.target.selectedOptions});\r\n        });\r\n\r\n        // Add event listener for export button\r\n        this.addEventListener(this.getElement(this.selectors.EXPORT_BTN), 'click', (e) => {\r\n            e.preventDefault();\r\n            this._handleExportChecklistButtonClick(e);\r\n        });\r\n\r\n        // Add event listener for import button\r\n        this.addEventListener(this.getElement(this.selectors.IMPORT_BTN), 'click', (e) => {\r\n            e.preventDefault();\r\n            this._handleImportChecklistButtonClick(e);\r\n        });\r\n\r\n        const spinnerElement = document.querySelector(this.selectors.LOADING_SPINNER);\r\n        spinnerElement.classList.add('d-none');\r\n\r\n        const mainElement = document.querySelector(this.selectors.MAIN_ELEMENT);\r\n        mainElement.classList.remove('d-none');\r\n        mainElement.classList.add('d-flex');\r\n\r\n    }\r\n\r\n    _handleFilterUpdate(event) {\r\n\r\n        // Check if the created element has id 0 (No selection)\r\n        if (event.element.id === \"0\") {\r\n\r\n            const roomSelect = this.getElement(this.selectors.ROOM_SELECT);\r\n\r\n            // Unselect all options except the one with value \"0\"\r\n            for (let option of roomSelect.options) {\r\n                if (option.value !== \"0\") {\r\n                    option.selected = false;\r\n                } else {\r\n                    option.selected = true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    async _handleAddChecklistItemButtonClick() {\r\n        const modalForm = new ModalForm({\r\n            formClass: \"mod_bookit\\\\local\\\\form\\\\masterchecklist\\\\edit_checklist_item_form\",\r\n            args: {\r\n                masterid: 1,\r\n                itemid: null,\r\n                categories: Array.from(this.reactive.state.checklistcategories.values()),\r\n            },\r\n            modalConfig: {\r\n                title: await getString('checklistitem', 'mod_bookit'),\r\n            },\r\n\r\n        });\r\n\r\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (response) => {\r\n            this.reactive.dispatch('checklistitemCreated', response.detail);\r\n        });\r\n\r\n        modalForm.show();\r\n    }\r\n\r\n\r\n    async _handleAddChecklistCategoryButtonClick() {\r\n        const modalForm = new ModalForm({\r\n            formClass: \"mod_bookit\\\\local\\\\form\\\\masterchecklist\\\\edit_checklist_category_form\",\r\n            args: {\r\n                masterid: 1\r\n            },\r\n            modalConfig: {\r\n                title: await getString('checklistcategory', 'mod_bookit'),\r\n            },\r\n        });\r\n\r\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (response) => {\r\n            this.reactive.stateManager.processUpdates(response.detail);\r\n\r\n        });\r\n\r\n        modalForm.show();\r\n    }\r\n\r\n    async _handleExportChecklistButtonClick() {\r\n        // Get masterid from reactive state instead of dataset to avoid timing issues\r\n        const masterid = this.reactive.state.masterchecklists?.get(1)?.id || 1;\r\n\r\n        const modalForm = new ModalForm({\r\n            formClass: \"mod_bookit\\\\local\\\\form\\\\masterchecklist\\\\export_checklist_form\",\r\n            args: {\r\n                masterid: masterid\r\n            },\r\n            modalConfig: {\r\n                title: await getString('export', 'mod_bookit'),\r\n            },\r\n            saveButtonText: await getString('export', 'mod_bookit'),\r\n        });\r\n\r\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, async(response) => {\r\n            if (response.detail.success && response.detail.downloadurl) {\r\n                window.open(response.detail.downloadurl, '_blank');\r\n                Toast.add(await getString('export_success', 'mod_bookit'), {type: 'success'});\r\n            } else {\r\n                Toast.add(response.detail.message || await getString('export_error', 'mod_bookit'), {type: 'error'});\r\n            }\r\n        });\r\n\r\n        modalForm.show();\r\n    }\r\n\r\n    async _handleImportChecklistButtonClick() {\r\n        // Get masterid from reactive state instead of dataset to avoid timing issues\r\n        const masterid = this.reactive.state.masterchecklists?.get(1)?.id || 1;\r\n\r\n        const modalForm = new ModalForm({\r\n            formClass: \"mod_bookit\\\\local\\\\form\\\\masterchecklist\\\\import_checklist_form\",\r\n            args: {\r\n                masterid: masterid\r\n            },\r\n            modalConfig: {\r\n                title: await getString('import', 'mod_bookit'),\r\n            },\r\n            saveButtonText: await getString('import', 'mod_bookit'),\r\n        });\r\n\r\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, async(response) => {\r\n            if (response.detail.success) {\r\n                Toast.add(response.detail.message || await getString('importsuccessful', 'mod_bookit'), {type: 'success'});\r\n                if (response.detail.reload) {\r\n                    // Reload the page to show imported data\r\n                    window.location.reload();\r\n                }\r\n            } else {\r\n                Toast.add(response.detail.message || await getString('importfailed', 'mod_bookit'), {type: 'error'});\r\n            }\r\n        });\r\n\r\n        modalForm.show();\r\n    }\r\n\r\n    _handleCategoryCreatedEvent(event) {\r\n\r\n        if (this.reactive.state.checklistcategories && this.reactive.state.checklistcategories.size > 0) {\r\n            const noContentElement = this.getElement(this.selectors.NOCONTENT);\r\n            if (noContentElement) {\r\n                noContentElement.remove();\r\n            }\r\n        }\r\n\r\n        Templates.renderForPromise('mod_bookit/masterchecklist/bookit_checklist_category',\r\n            {\r\n                id: event.element.id,\r\n                name: event.element.name,\r\n                order: event.element.order,\r\n                masterid: 1, // XXX TODO get from state\r\n                type: 'category',\r\n            })\r\n            .then(({html, js}) => {\r\n                return Templates.appendNodeContents(this.getElement(this.selectors.TABLE), html, js);\r\n            })\r\n            .then(async() => {\r\n                await Toast.add(await getString('checklistcategorysuccess', 'mod_bookit'),\r\n                    {type: 'success'});\r\n\r\n                if (this.reactive.state.activeRole.id !== 0 || this.reactive.state.activeRoom.id !== 0) {\r\n                    const components = this.reactive.components;\r\n                    const categoryResults = this.helper.findComponents(components, {\r\n                        dataset: {bookitTbodyCategoryId: event.element.id.toString()},\r\n                        onlyFirst: false\r\n                    });\r\n\r\n                    const categoryComponent = categoryResults.find(comp => typeof comp._handleFilterUpdate === 'function');\r\n                    if (categoryComponent) {\r\n                        categoryComponent._handleFilterUpdate(event);\r\n                    }\r\n                }\r\n                return;\r\n            })\r\n            .catch(error => {\r\n                window.console.error('Error rendering checklist category:', error);\r\n                return;\r\n            });\r\n    }\r\n\r\n    _handleItemCreatedEvent(event) {\r\n\r\n        const targetElement = this.getElement(`#bookit-master-checklist-tbody-category-${event.element.category}`);\r\n\r\n        const roomNames = [];\r\n        if (event.element.roomnames) {\r\n            event.element.roomnames.forEach((room) => {\r\n                roomNames.push({\r\n                    'roomid': room.roomid,\r\n                    'roomname': room.roomname,\r\n                    'eventcolor': room.eventcolor,\r\n                    'textclass': room.textclass,\r\n                });\r\n            });\r\n        }\r\n\r\n        const roleNames = [];\r\n        if (event.element.rolenames) {\r\n            event.element.rolenames.forEach((role) => {\r\n                roleNames.push({\r\n                    'roleid': role.roleid,\r\n                    'rolename': role.rolename,\r\n                    'extraclasses': role.extraclasses,\r\n                });\r\n            });\r\n        }\r\n\r\n        Templates.renderForPromise('mod_bookit/masterchecklist/bookit_checklist_item',\r\n            {\r\n                id: event.element.id,\r\n                title: event.element.title,\r\n                order: event.element.order,\r\n                categoryid: event.element.category,\r\n                roomids: event.element.roomids,\r\n                roomnames: roomNames,\r\n                roleids: event.element.roleids,\r\n                rolenames: roleNames,\r\n                type: 'item',\r\n            })\r\n            .then(({html, js}) => {\r\n                return Templates.appendNodeContents(targetElement, html, js);\r\n            })\r\n            .then(async() => {\r\n                await Toast.add(await getString('checklistitemsuccess', 'mod_bookit'),\r\n                    {type: 'success'});\r\n\r\n                // Find and trigger filter update on parent category component\r\n                const components = this.reactive.components;\r\n                const categoryResults = this.helper.findComponents(components, {\r\n                    dataset: {bookitCategoryId: event.element.category},\r\n                    onlyFirst: true\r\n                });\r\n\r\n                if (categoryResults.length > 0) {\r\n                    const categoryComponent = categoryResults[0];\r\n                    if (categoryComponent._handleFilterUpdate) {\r\n                        categoryComponent._handleFilterUpdate(event);\r\n                    }\r\n                }\r\n                return;\r\n            })\r\n            .catch(error => {\r\n                window.console.error('Error rendering checklist item:', error);\r\n                return;\r\n            });\r\n    }\r\n\r\n    _handleItemDeletedEvent(event) {\r\n        const targetElement = this.getElement(`#bookit-master-checklist-item-${event.element.id}`);\r\n        targetElement.remove();\r\n\r\n        Toast.add(getString('checklistitemdeleted', 'mod_bookit', {title: event.element.title}),\r\n            {type: 'success'});\r\n    }\r\n\r\n    _replaceRenderedItem(event) {\r\n\r\n        const actionParts = event.action.split('.');\r\n        const fieldPart = actionParts[1].split(':')[0];\r\n\r\n        if (fieldPart.endsWith('ids')) {\r\n\r\n            const stateItem = this.reactive.state.checklistitems.get(event.element.id);\r\n\r\n            const selector = `td[data-bookit-checklistitem-tabledata-${fieldPart}-id=\"${event.element.id}\"]`;\r\n\r\n            const targetElement = this.getElement(selector);\r\n            let templateName, templateData;\r\n\r\n            if (fieldPart.startsWith('room')) {\r\n\r\n                templateName = 'mod_bookit/masterchecklist/bookit_checklist_item_rooms';\r\n                templateData = {\r\n                    id: event.element.id,\r\n                    roomnames: stateItem.roomnames\r\n                };\r\n            } else if (fieldPart.startsWith('role')) {\r\n\r\n                templateName = 'mod_bookit/masterchecklist/bookit_checklist_item_roles';\r\n                templateData = {\r\n                    id: event.element.id,\r\n                    rolenames: stateItem.rolenames\r\n                };\r\n            } else {\r\n                return;\r\n            }\r\n\r\n            Templates.renderForPromise(templateName, templateData)\r\n            .then(({html, js}) => {\r\n                return Templates.replaceNode(targetElement, html, js);\r\n            })\r\n            .then(async() => {\r\n                return Toast.add(await getString('checklistitemupdatesuccess', 'mod_bookit'),\r\n                    {type: 'success'});\r\n            })\r\n            .catch(error => {\r\n                window.console.error('Error rendering checklist item field update:', error);\r\n            });\r\n\r\n        } else {\r\n            const elementSelector = `span[data-bookit-checklistitem-tabledata-${fieldPart}-id=\"${event.element.id}\"]`;\r\n\r\n            const targetElement = this.getElement(elementSelector);\r\n\r\n            if (targetElement) {\r\n                targetElement.innerHTML = event.element[fieldPart];\r\n            } else {\r\n                window.console.error('Target element not found for selector:', elementSelector);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    _handleCategoryDeletedEvent(event) {\r\n        const targetElement = this.getElement(`#bookit-master-checklist-tbody-category-${event.element.id}`);\r\n\r\n        targetElement.remove();\r\n\r\n        Toast.add(getString('checklistcategorydeleted', 'mod_bookit', {name: event.element.name}),\r\n            {type: 'success'});\r\n    }\r\n\r\n    _handleCategoryNameUpdatedEvent(event) {\r\n        const targetElement = this.getElement(`#bookit-master-checklist-category-row-${event.element.id}`);\r\n\r\n        Templates.renderForPromise('mod_bookit/masterchecklist/bookit_checklist_category_row',\r\n            {\r\n                id: event.element.id,\r\n                name: event.element.name,\r\n                order: event.element.order,\r\n                type: 'category',\r\n            })\r\n            .then(({html, js}) => {\r\n                return Templates.replaceNode(targetElement, html, js);\r\n            })\r\n            .then(async() => {\r\n                await Toast.add(await getString('checklistcategoryupdatesuccess', 'mod_bookit'),\r\n                    {type: 'success'});\r\n                return this.dispatchEvent(this.events.categoryRendered, {\r\n                    categoryId: event.element.id\r\n                });\r\n            })\r\n            .catch(error => {\r\n                window.console.error('Error rendering checklist category:', error);\r\n            });\r\n\r\n    }\r\n\r\n\r\n    _handleRoleUpdate(event) {\r\n        const allCategoryElements = document.querySelectorAll(this.selectors.ALL_CATEGORY_TABLE_ROWS);\r\n        allCategoryElements.forEach(categoryElement => {\r\n\r\n            const category = this.reactive.state.checklistcategories.get(categoryElement.dataset.bookitCategoryId);\r\n            const items = [...category.items];\r\n            var hasVisibleItems = false;\r\n\r\n            const activeRoom = this.reactive.state.activeRoom.id;\r\n\r\n            items.forEach(itemId => {\r\n\r\n                // XXX TODO fix rooms\r\n\r\n                const itemElement = document.querySelector(`tr[data-bookit-checklistitem-id=\"${itemId}\"]`);\r\n\r\n                if (activeRoom === 0) {\r\n\r\n                    if (parseInt(itemElement.dataset.bookitChecklistitemRole) === event.element.id || event.element.id === 0) {\r\n                        itemElement.classList.remove('d-none');\r\n                        if (!hasVisibleItems) {\r\n                            hasVisibleItems = true;\r\n                        }\r\n                    } else {\r\n                        itemElement.classList.add('d-none');\r\n                    }\r\n                } else if (activeRoom === parseInt(itemElement.dataset.bookitChecklistitemRoom)) {\r\n\r\n                    if (parseInt(itemElement.dataset.bookitChecklistitemRole) === event.element.id || event.element.id === 0) {\r\n                        itemElement.classList.remove('d-none');\r\n                        if (!hasVisibleItems) {\r\n                            hasVisibleItems = true;\r\n                        }\r\n                    } else {\r\n                        itemElement.classList.add('d-none');\r\n                    }\r\n                } else {\r\n\r\n                    itemElement.classList.add('d-none');\r\n                }\r\n            });\r\n\r\n            if (!hasVisibleItems) {\r\n                categoryElement.classList.add('d-none');\r\n            } else {\r\n                categoryElement.classList.remove('d-none');\r\n            }\r\n\r\n        });\r\n    }\r\n}"],"names":["BaseComponent","categoryRendered","target","selectors","this","element","document","querySelector","reactive","masterChecklistReactiveInstance","SELECTORS","create","helper","ChecklistHelper","getWatchers","watch","handler","_handleCategoryCreatedEvent","_handleCategoryDeletedEvent","_handleCategoryNameUpdatedEvent","_handleItemCreatedEvent","_handleItemDeletedEvent","_replaceRenderedItem","_handleFilterUpdate","stateReady","state","name","masterchecklists","get","getElement","MASTER_CHECKLIST_TITLE","innerHTML","addEventListener","ADD_CHECKLIST_ITEM_BUTTON","e","preventDefault","_handleAddChecklistItemButtonClick","ADD_CHECKLIST_CATEGORY_BUTTON","_handleAddChecklistCategoryButtonClick","ROLE_SELECT","dispatch","id","value","ROOM_SELECT","options","selectedOptions","EXPORT_BTN","_handleExportChecklistButtonClick","IMPORT_BTN","_handleImportChecklistButtonClick","LOADING_SPINNER","classList","add","mainElement","MAIN_ELEMENT","remove","event","roomSelect","option","selected","modalForm","ModalForm","formClass","args","masterid","itemid","categories","Array","from","checklistcategories","values","modalConfig","title","events","FORM_SUBMITTED","response","detail","show","stateManager","processUpdates","saveButtonText","async","success","downloadurl","window","open","Toast","type","message","reload","location","size","noContentElement","NOCONTENT","renderForPromise","order","then","_ref","html","js","Templates","appendNodeContents","TABLE","activeRole","activeRoom","components","categoryComponent","findComponents","dataset","bookitTbodyCategoryId","toString","onlyFirst","find","comp","catch","error","console","targetElement","category","roomNames","roomnames","forEach","room","push","roomid","roomname","eventcolor","textclass","roleNames","rolenames","role","roleid","rolename","extraclasses","categoryid","roomids","roleids","_ref2","categoryResults","bookitCategoryId","length","fieldPart","action","split","endsWith","stateItem","checklistitems","selector","templateName","templateData","startsWith","_ref3","replaceNode","elementSelector","_ref4","dispatchEvent","categoryId","_handleRoleUpdate","querySelectorAll","ALL_CATEGORY_TABLE_ROWS","categoryElement","items","hasVisibleItems","itemId","itemElement","parseInt","bookitChecklistitemRole","bookitChecklistitemRoom"],"mappings":"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"}