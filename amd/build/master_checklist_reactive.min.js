define("mod_bookit/master_checklist_reactive",["exports","core/reactive","mod_bookit/master_checklist_mutations"],(function(_exports,_reactive,_master_checklist_mutations){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.masterChecklistReactiveInstance=_exports.init=_exports.SELECTORS=void 0,_master_checklist_mutations=(obj=_master_checklist_mutations)&&obj.__esModule?obj:{default:obj};const SELECTORS={TABLE:"#mod-bookit-master-checklist-table",MAIN_ELEMENT:"#mod-bookit-master-checklist",LOADING_SPINNER:"#mod-bookit-master-checklist-spinner",ADD_CHECKLIST_CATEGORY_BUTTON:"#add-checklist-category-button",ADD_CHECKLIST_ITEM_BUTTON:"#add-checklist-item-button",MASTER_CHECKLIST_TITLE:"#mod-bookit-master-checklist-title",ALL_CATEGORY_TABLE_ROWS:"tr[data-bookit-category-id]",ALL_ITEM_TABLE_ROWS:"tr[data-bookit-checklistitem-id]",TABLE_BODY:"#mod-bookit-master-checklist-tbody",ALL_ROLE_OPTIONS:"option[data-bookit-roleoption]",ALL_ROOM_OPTIONS:"option[data-bookit-roomoption]",ROLE_SELECT:"#bookit-master-role-select",ROOM_SELECT:"#bookit-master-room-select"};_exports.SELECTORS=SELECTORS;const EVENTNAME="mod_bookit:master_checklist_state_event",masterChecklistReactiveInstance=new _reactive.Reactive({eventName:EVENTNAME,eventDispatch:function(detail,target){window.console.log("dispatch master checklist state event function"),void 0===target&&(target=document);target.dispatchEvent(new CustomEvent(EVENTNAME,{bubbles:!0,detail:detail}))},mutations:new _master_checklist_mutations.default,name:"Moodle Bookit Master Checklist"});_exports.masterChecklistReactiveInstance=masterChecklistReactiveInstance;_exports.init=elementId=>{loadState(masterChecklistReactiveInstance)};const loadState=async reactive=>{window.console.log("loading state");const tableElement=document.querySelector(SELECTORS.TABLE),stateData={masterchecklists:[{id:tableElement.dataset.masterChecklistId,name:tableElement.dataset.masterChecklistName,mastercategoryorder:tableElement.dataset.masterChecklistCategoryorder}],activechecklist:{id:tableElement.dataset.masterChecklistId},checklistcategories:[],checklistitems:[],roles:[],rooms:[],activeRole:{id:0},activeRoom:[{id:0,name:"No selection"}]};document.querySelectorAll(SELECTORS.ALL_CATEGORY_TABLE_ROWS).forEach((categoryRow=>{const categoryItemRows=document.querySelectorAll('tr[data-bookit-checklistitem-categoryid="'.concat(categoryRow.dataset.bookitCategoryId,'"]')),checklistItems=[];categoryItemRows.forEach((itemRow=>{checklistItems.push(parseInt(itemRow.dataset.bookitChecklistitemId))})),stateData.checklistcategories.push({id:categoryRow.dataset.bookitCategoryId,name:categoryRow.dataset.bookitCategoryName,order:categoryRow.dataset.bookitCategoryOrder,items:checklistItems})}));document.querySelectorAll(SELECTORS.ALL_ITEM_TABLE_ROWS).forEach((itemRow=>{const roomElements=itemRow.querySelectorAll("span[data-bookit-checklistitem-tabledata-room-id]"),roleElements=itemRow.querySelectorAll("span[data-bookit-checklistitem-tabledata-role-id]"),roomNames=[];roomElements.forEach((roomElement=>{roomNames.push({roomid:roomElement.dataset.bookitChecklistitemTabledataRoomId,roomname:roomElement.dataset.bookitChecklistitemRoomname,textclass:roomElement.dataset.bookitChecklistitemTabledataRoomTextclass,eventcolor:roomElement.dataset.bookitChecklistitemTabledataRoomColor})}));const roleNames=[];roleElements.forEach((roleElement=>{roleNames.push({roleid:roleElement.dataset.bookitChecklistitemTabledataRoleId,rolename:roleElement.dataset.bookitChecklistitemRolename})})),stateData.checklistitems.push({id:itemRow.dataset.bookitChecklistitemId,title:itemRow.dataset.bookitChecklistitemTitle,order:itemRow.dataset.bookitChecklistitemOrder,categoryid:itemRow.dataset.bookitChecklistitemCategoryid,roomids:itemRow.dataset.bookitChecklistitemRoomids,roomnames:roomNames,roleids:itemRow.dataset.bookitChecklistitemRoleids,rolenames:roleNames})}));document.querySelectorAll(SELECTORS.ALL_ROOM_OPTIONS).forEach((roomOption=>{stateData.rooms.push({id:roomOption.value,name:roomOption.dataset.bookitRoomname})}));document.querySelectorAll(SELECTORS.ALL_ROLE_OPTIONS).forEach((roleOption=>{stateData.roles.push({id:roleOption.value,name:roleOption.dataset.bookitRolename})})),reactive.setInitialState(stateData)}}));

//# sourceMappingURL=master_checklist_reactive.min.js.map